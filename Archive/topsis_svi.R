rm(list=ls()) 
library(topsis) 
library(readxl)
library(writexl)

exceldata <- read_excel("G:/My Drive/Dottorato UNIBA/Baringo/Do/topsis_criteria_svi.xlsx")  
dataframe <- data.frame(exceldata)
objectid_1<-dataframe$objectid_1
decision <- as.matrix(dataframe[,2:ncol(dataframe)])
rownames(decision)<-objectid_1

weights <- read_excel("G:/My Drive/Dottorato UNIBA/Baringo/Do/topsis_weight_svi.xlsx")$weight 
impacts <- read_excel("G:/My Drive/Dottorato UNIBA/Baringo/Do/topsis_impact_svi.xlsx")$impact 
topsisdf<-topsis(decision, weights, impacts) 
topsisdf$objectid_1<-objectid_1
topsisdf<-topsisdf[,ncol(topsisdf):1]
write_xlsx(topsisdf,"G:/My Drive/Dottorato UNIBA/Baringo/Output/topsisoutcome_svi.xlsx") 



